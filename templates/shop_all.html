{% extends "base.html" %}
{% set title = "Shop All Original Skincare Products in Pakistan | Siebel Skincare" %}
{% set description = "Browse the complete collection of original skincare products in Pakistan. From whitening serums, face washes to sunblocks and anti-itching bars — 100% authentic, fast delivery, and cash on delivery available." %}
{% set keywords = "skincare Pakistan, buy skincare online, face wash, whitening serum, sunblock Pakistan, anti itching soap, body lotion Pakistan, siebel skincare" %}
{% set canonical = "https://www.siebel.store/shop-all" %}
{% set og_title = title %}
{% set og_description = description %}
{% set og_image = "https://www.siebel.store/static/images/banner1.png" %}
{% set og_url = canonical %}
{% block content %}

<!-- Breadcrumb -->
<div class="bg-gray-100 py-4 border-b border-gray-300">
  <h1 class="text-center text-2xl font-bold text-gray-800">Shop All</h1>
</div>

<div class="md:px-8 px-4 py-6 relative">

  <!-- Mobile Filter Button -->
  <div class="flex justify-between items-center mb-4 md:hidden">
    <button onclick="openFilterPanel()" class="flex items-center gap-2 px-4 py-2 rounded text-gray-500 bg-transparent">
      <img src="{{ url_for('static', filename='images/filter.png') }}" alt="Filter" class="h-5 w-5">
      <span class="font-semibold">Filter</span>
    </button>
  </div>

  <div class="flex flex-col md:flex-row md:gap-6">

    <!-- Desktop Filters Sidebar -->
    <aside class="hidden md:block md:w-1/4 bg-gray-50 p-4 rounded shadow">
      <form method="GET" action="/shop-all">
        <h2 class="text-lg font-bold mb-4">Filter Products</h2>

        <!-- Product Types -->
        <div class="mb-6">
          <h3 class="font-medium mb-2">Product Type</h3>
          <div class="space-y-2 text-sm">
            {% for ptype in product_types %}
              <label class="flex items-center gap-2">
                <input type="checkbox" name="type" value="{{ ptype }}" class="form-checkbox text-pink-500"
                {% if ptype in request.args.getlist('type') %}checked{% endif %}>
                {{ ptype }}
              </label>
            {% endfor %}
          </div>
        </div>

        <!-- Price Range -->
        <div class="mb-6">
          <h3 class="font-medium mb-2">Price Range (Rs)</h3>
          <div class="flex justify-between text-sm mb-2">
            <span id="minPriceLabel">500</span>
            <span id="maxPriceLabel">5000</span>
          </div>

          <div class="relative h-2 bg-gray-300 rounded mb-4">
            <input type="range" min="500" max="5000" value="{{ request.args.get('min_price', 500) }}" id="minPrice"
              class="absolute w-full opacity-0 h-2 z-20 cursor-pointer" step="100" oninput="updatePriceLabels()">
            <input type="range" min="500" max="5000" value="{{ request.args.get('max_price', 5000) }}" id="maxPrice"
              class="absolute w-full opacity-0 h-2 z-20 cursor-pointer" step="100" oninput="updatePriceLabels()">
            <div id="rangeTrack" class="absolute h-2 bg-pink-400 rounded left-0 right-0"></div>
          </div>

          <input type="hidden" name="min_price" id="minPriceInput" value="500">
          <input type="hidden" name="max_price" id="maxPriceInput" value="5000">
        </div>

        <button type="submit" class="w-full bg-pink-400 text-white py-2 rounded-full hover:bg-pink-600 transition">
          Apply Filters
        </button>
      </form>
    </aside>

    <!-- Product Grid -->
    <div class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-6 flex-1">
      {% for product in products %}
        <div class="border rounded-lg overflow-hidden shadow hover:shadow-lg transition bg-white">
          <a href="/product/{{ product.slug }}">
            <img src="{{ url_for('static', filename=product.image) }}" alt="{{ product.name }}" class="w-full h-56 object-cover">
          </a>
          <div class="p-4">
            <h2 class="text-lg font-semibold mb-1">{{ product.name }}</h2>
            <div class="text-black-400 text-sm mb-1">★★★★★ ({{ product.rating }}) {{ product.reviews }}</div>
            <div class="flex items-center gap-2 mb-3">
              <span class="text-gray-500 line-through text-sm">Rs {{ product.before_price }}</span>
              <span class="text-red-500 font-thin text-lg">Rs {{ product.price }}</span>
            </div>
            <button onclick="addToCart({{ product.id }}, 1)" class="w-full bg-pink-400 text-white py-2 rounded-full flex items-center justify-center gap-2 hover:bg-pink-600 transition">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2M7.16 14.26l.03.02c.28.19.61.28.94.28H17v-2H9.42l-.93-4H18v-2H7.1l-.59-2H2v2h2.18l3.6 7.59-.62 1.16c-.16.29-.16.63 0 .92.16.3.44.51.77.59z"/>
              </svg>
              Add to Cart
            </button>
          </div>
        </div>
      {% endfor %}
    </div>

  </div>

  <!-- Mobile Slide-In Filter Panel -->
  <div id="filterPanel" class="fixed top-0 left-0 w-80 max-w-full h-full bg-white shadow-xl z-50 transform -translate-x-full transition-transform duration-300 ease-in-out overflow-y-auto">
    <div class="p-4 border-b flex justify-between items-center">
      <h2 class="text-lg font-bold">Filter Products</h2>
      <button onclick="closeFilterPanel()" class="text-gray-600 text-2xl">&times;</button>
    </div>

    <form method="GET" action="/shop-all" class="p-4">
      <!-- Product Types -->
      <div class="mb-6">
        <h3 class="font-medium mb-2">Product Type</h3>
        <div class="space-y-2 text-sm">
          {% for ptype in product_types %}
            <label class="flex items-center gap-2">
              <input type="checkbox" name="type" value="{{ ptype }}" class="form-checkbox text-pink-500"
              {% if ptype in request.args.getlist('type') %}checked{% endif %}>
              {{ ptype }}
            </label>
          {% endfor %}
        </div>
      </div>

      <!-- Price Range -->
      <div class="mb-6">
        <h3 class="font-medium mb-2">Price Range (Rs)</h3>
        <div class="flex justify-between text-sm mb-2">
          <span id="minPriceLabel2">500</span>
          <span id="maxPriceLabel2">5000</span>
        </div>

        <div class="relative h-2 bg-gray-300 rounded mb-4">
          <input type="range" min="500" max="5000" value="{{ request.args.get('min_price', 500) }}" id="minPrice2"
            class="absolute w-full opacity-0 h-2 z-20 cursor-pointer" step="100" oninput="updatePriceLabels2()">
          <input type="range" min="500" max="5000" value="{{ request.args.get('max_price', 5000) }}" id="maxPrice2"
            class="absolute w-full opacity-0 h-2 z-20 cursor-pointer" step="100" oninput="updatePriceLabels2()">
          <div id="rangeTrack2" class="absolute h-2 bg-pink-400 rounded left-0 right-0"></div>
        </div>

        <input type="hidden" name="min_price" id="minPriceInput2" value="500">
        <input type="hidden" name="max_price" id="maxPriceInput2" value="5000">
      </div>

      <button type="submit" class="w-full bg-pink-400 text-white py-2 rounded-full hover:bg-pink-600 transition">
        Apply Filters
      </button>
    </form>
  </div>

</div>

<script>
function openFilterPanel() {
  document.getElementById('filterPanel').classList.remove('-translate-x-full');
}
function closeFilterPanel() {
  document.getElementById('filterPanel').classList.add('-translate-x-full');
}
function updatePriceLabels() {
  const minSlider = document.getElementById('minPrice');
  const maxSlider = document.getElementById('maxPrice');
  const minLabel = document.getElementById('minPriceLabel');
  const maxLabel = document.getElementById('maxPriceLabel');
  const rangeTrack = document.getElementById('rangeTrack');

  let minVal = parseInt(minSlider.value);
  let maxVal = parseInt(maxSlider.value);

  if (minVal > maxVal - 500) minVal = maxVal - 500;
  if (maxVal < minVal + 500) maxVal = minVal + 500;

  minLabel.textContent = minVal;
  maxLabel.textContent = maxVal;

  document.getElementById('minPriceInput').value = minVal;
  document.getElementById('maxPriceInput').value = maxVal;

  const rangeWidth = maxSlider.max - minSlider.min;
  const minPercent = ((minVal - minSlider.min) / rangeWidth) * 100;
  const maxPercent = ((maxVal - minSlider.min) / rangeWidth) * 100;

  rangeTrack.style.left = `${minPercent}%`;
  rangeTrack.style.right = `${100 - maxPercent}%`;
}

function updatePriceLabels2() {
  const minSlider = document.getElementById('minPrice2');
  const maxSlider = document.getElementById('maxPrice2');
  const minLabel = document.getElementById('minPriceLabel2');
  const maxLabel = document.getElementById('maxPriceLabel2');
  const rangeTrack = document.getElementById('rangeTrack2');

  let minVal = parseInt(minSlider.value);
  let maxVal = parseInt(maxSlider.value);

  if (minVal > maxVal - 500) minVal = maxVal - 500;
  if (maxVal < minVal + 500) maxVal = minVal + 500;

  minLabel.textContent = minVal;
  maxLabel.textContent = maxVal;

  document.getElementById('minPriceInput2').value = minVal;
  document.getElementById('maxPriceInput2').value = maxVal;

  const rangeWidth = maxSlider.max - minSlider.min;
  const minPercent = ((minVal - minSlider.min) / rangeWidth) * 100;
  const maxPercent = ((maxVal - minSlider.min) / rangeWidth) * 100;

  rangeTrack.style.left = `${minPercent}%`;
  rangeTrack.style.right = `${100 - maxPercent}%`;
}

updatePriceLabels();
updatePriceLabels2();
</script>

{% endblock %}
